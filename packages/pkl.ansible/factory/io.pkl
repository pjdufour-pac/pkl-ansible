open module io

extends "../modules.pkl"

import "@utils/utils.pkl" as utils

import "../tasks/io.pkl" as tasks_io
import "../tasks/shell.pkl" as tasks_shell

class FactoryIo {

    function CreateDirectories(names: List<String>|Listing<String>): tasks_io.AnsibleTaskDefinitionDirectories = new tasks_io.AnsibleTaskDefinitionDirectories {
        with_items = names
    }

    function DeleteSocketFiles(_name: String): tasks_shell.AnsibleTaskDefinitionShell = new tasks_shell.AnsibleTaskDefinitionShell {
        name = "Delete socket files"
            shell = new Shell {
            cmd = "rm -f {{ "+(utils.slugify(_name))+"_socket_files|join(' ') }}"
        }
        `when` = "{{ "+(utils.slugify(_name))+"_socket_files | length > 0 }}"
    }
}